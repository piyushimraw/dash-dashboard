---
phase: 02-mfe-migration
plan: 09
type: execute
wave: 5
depends_on: [02-04, 02-05, 02-06, 02-07, 02-08]
files_modified:
  - apps/shell/src/pages/
  - apps/shell/src/forms/
  - apps/shell/src/components/reservation-lookup-components/
  - apps/shell/src/features/rent-vehicle/
  - apps/shell/src/hooks/useRentVehicleFilters.ts
  - apps/shell/src/types/rent-vehicles/
  - apps/shell/src/components/form/
  - apps/shell/src/components/ui/table/
autonomous: false

must_haves:
  truths:
    - "All 9 routes load MFE content (not local shell pages)"
    - "Build produces separate chunk for each MFE"
    - "User can navigate between all routes without errors"
    - "Forms validate correctly in rent and return MFEs"
    - "DataTable renders correctly in reservation lookup"
    - "No duplicate code in shell pages/ directory"
  artifacts:
    - path: "apps/shell/dist/assets/"
      provides: "Separate chunks for each MFE route"
  key_links:
    - from: "apps/shell/src/routes/_auth.*.tsx"
      to: "apps/mfe-*/src/index.ts"
      via: "workspace package imports"
      pattern: "from '@apps/mfe-"
---

<objective>
Final verification of Phase 2 migration - clean up shell, verify all routes, and confirm MFE isolation with human verification.

Purpose: Ensure complete migration with no regressions. Remove obsolete shell code that has been extracted to MFE packages.

Output: Clean shell with all MFE code in packages, human-verified functionality
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-mfe-migration/02-RESEARCH.md

# Prior plan summaries
@.planning/phases/02-mfe-migration/02-04-SUMMARY.md
@.planning/phases/02-mfe-migration/02-05-SUMMARY.md
@.planning/phases/02-mfe-migration/02-06-SUMMARY.md
@.planning/phases/02-mfe-migration/02-07-SUMMARY.md
@.planning/phases/02-mfe-migration/02-08-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Clean up shell pages directory</name>
  <files>
    apps/shell/src/pages/
  </files>
  <action>
Remove migrated page files from shell (keep LoginPage.tsx and UnAuthorized.tsx which are shell-specific):

Delete these files (now in MFE packages):
- `apps/shell/src/pages/DashboardPage.tsx` (in @apps/mfe-dashboard)
- `apps/shell/src/pages/RentPage.tsx` (in @apps/mfe-rent)
- `apps/shell/src/pages/ReturnPage.tsx` (in @apps/mfe-return)
- `apps/shell/src/pages/SettingPage.tsx` (in @apps/mfe-settings)
- `apps/shell/src/pages/ReportsPage.tsx` (in @apps/mfe-reports)
- `apps/shell/src/pages/AaoPage.tsx` (in @apps/mfe-aao)
- `apps/shell/src/pages/CarControl.tsx` (in @apps/mfe-car-control)
- `apps/shell/src/pages/VehicleExchangePage.tsx` (in @apps/mfe-vehicle-exchange)
- `apps/shell/src/pages/ReservationLookupPage.tsx` (in @apps/mfe-reservation-lookup)

Keep:
- `apps/shell/src/pages/LoginPage.tsx` (shell auth)
- `apps/shell/src/pages/UnAuthorized.tsx` (shell error page)

Verify shell still builds after deletion.
  </action>
  <verify>
`ls apps/shell/src/pages/` shows only LoginPage.tsx and UnAuthorized.tsx
`pnpm --filter @apps/shell build` succeeds
  </verify>
  <done>Migrated pages removed from shell, build still passes</done>
</task>

<task type="auto">
  <name>Task 2: Clean up shell forms and components</name>
  <files>
    apps/shell/src/forms/
    apps/shell/src/components/reservation-lookup-components/
    apps/shell/src/features/rent-vehicle/
    apps/shell/src/hooks/useRentVehicleFilters.ts
    apps/shell/src/types/rent-vehicles/
    apps/shell/src/components/form/
  </files>
  <action>
Remove migrated forms, components, and features from shell:

Delete these directories/files:
- `apps/shell/src/forms/rent/` (in @apps/mfe-rent)
- `apps/shell/src/forms/return/` (in @apps/mfe-return)
- `apps/shell/src/components/reservation-lookup-components/` (in @apps/mfe-reservation-lookup)
- `apps/shell/src/features/rent-vehicle/` (in @apps/mfe-reservation-lookup)
- `apps/shell/src/hooks/useRentVehicleFilters.ts` (in @apps/mfe-reservation-lookup)
- `apps/shell/src/types/rent-vehicles/` (in @apps/mfe-reservation-lookup)

For `apps/shell/src/components/form/`:
1. Check if `apps/shell/src/forms/login/` exists and uses local form components
2. If login form uses local form components from `@/components/form/`:
   - Update login form to import from `@packages/ui` instead (FormProvider, FormInput, FormSelect, FormError)
   - Then delete `apps/shell/src/components/form/` directory
3. If login form already uses `@packages/ui` or doesn't use form components:
   - Delete `apps/shell/src/components/form/` directory directly

Keep:
- `apps/shell/src/forms/login/` (shell auth - update imports if needed, keep the form itself)

Verify shell still builds after cleanup.
  </action>
  <verify>
`pnpm --filter @apps/shell build` succeeds
  </verify>
  <done>Migrated forms and components removed, login form updated if needed, build passes</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete MFE migration: 9 page-level MFEs extracted to apps/ packages, shell routes updated to import from MFE packages, shared components (forms, DataTable) extracted to @packages/ui, obsolete shell code removed.
  </what-built>
  <how-to-verify>
1. Start the dev server: `pnpm --filter @apps/shell dev`

2. Navigate to each route and verify content loads:
   - /dashboard - Quick actions card with navigation buttons
   - /rent - Form with customer fields, vehicle type, dates
   - /return - Card with return form
   - /reservation_lookup - Data table with search and filters
   - /settings - Placeholder text
   - /reports - Placeholder text
   - /aao - Placeholder text
   - /carcontrol - Placeholder text
   - /vehicle_exchange - Placeholder text

3. Test form validation:
   - /rent - Submit empty form, see validation errors
   - /rent - Fill valid data, form submits (console log)
   - /return - Same validation test

4. Test table functionality:
   - /reservation_lookup - Search filters data
   - Click column headers - sorting works
   - Filter panel opens and filters apply

5. Test error isolation:
   - Open browser console
   - Check for any React errors or warnings
   - Verify no duplicate React instances

6. Check build output:
   - Run `pnpm --filter @apps/shell build`
   - Check `apps/shell/dist/assets/` for separate route chunks
  </how-to-verify>
  <resume-signal>Type "approved" if all routes work correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. Shell pages/ directory only contains LoginPage.tsx and UnAuthorized.tsx
2. Shell forms/ directory only contains login/ (if needed)
3. All MFE-specific code removed from shell
4. `pnpm --filter @apps/shell build` passes
5. Human verified all 9 routes work correctly
</verification>

<success_criteria>
- All migrated code removed from shell
- Shell only contains auth pages and shared infrastructure
- All 9 MFE routes verified working by human
- Build produces separate chunks for each MFE
- No regressions in functionality
</success_criteria>

<output>
After completion, create `.planning/phases/02-mfe-migration/02-09-SUMMARY.md`
</output>
