# Codebase Structure

**Analysis Date:** 2026-01-22

## Directory Layout

```
new-dash-ui/
├── src/                          # Main application source code
│   ├── __tests__/                # Integration and unit tests
│   ├── assets/                   # Static assets (images, fonts, etc.)
│   ├── auth/                     # Authentication utilities and guards
│   ├── components/               # Reusable React components
│   │   ├── dialogs/              # Modal/dialog components
│   │   ├── form/                 # Form-specific components (FormProvider, FormInput, etc.)
│   │   ├── reservation-lookup-components/  # Reservation lookup feature components
│   │   ├── ui/                   # Base UI components (button, card, input, etc.)
│   │   ├── PWAInstallBanner.tsx  # Progressive Web App install prompt
│   │   └── Sidebar.tsx           # Navigation sidebar with menu
│   ├── config/                   # Application configuration and constants
│   ├── features/                 # Feature-specific modules
│   │   └── rent-vehicle/         # Rent vehicle feature (hooks, API, mutations)
│   ├── forms/                    # Form components and schemas
│   │   ├── login/                # Login form
│   │   ├── rent/                 # Rent vehicle form
│   │   └── return/               # Return vehicle form
│   ├── hooks/                    # Custom React hooks
│   ├── icons/                    # Icon mappings and definitions
│   ├── lib/                      # Library functions and utilities
│   │   ├── api/                  # HTTP client and API utilities
│   │   ├── react-query/          # React Query configuration and query keys
│   │   └── utils.ts              # Utility functions (classname merging, etc.)
│   ├── pages/                    # Page/screen components
│   ├── routes/                   # TanStack Router file-based route definitions
│   ├── store/                    # Zustand state management stores
│   ├── types/                    # TypeScript type definitions
│   │   └── rent-vehicles/        # Rent vehicle feature types
│   ├── main.tsx                  # Application entry point
│   ├── router.ts                 # Router configuration
│   ├── routerContext.ts          # Router context type definitions
│   ├── routeTree.gen.ts          # Generated route tree (auto-generated by TanStack Router)
│   ├── index.css                 # Global styles (Tailwind)
│   ├── vite-env.d.ts             # Vite environment types
│   └── setupTests.ts             # Test environment setup
├── public/                       # Static public assets (favicon, PWA icons, etc.)
├── vite.config.ts                # Vite build configuration
├── tsconfig.json                 # TypeScript configuration (with path aliases)
├── package.json                  # Project dependencies and scripts
└── .planning/codebase/           # GSD planning documents
```

## Directory Purposes

**src/__tests__/:**
- Purpose: Test files for the application
- Contains: Unit and integration tests
- Key files: Test files follow filename.test.ts or filename.spec.ts convention

**src/assets/:**
- Purpose: Static assets used in the application
- Contains: Images, fonts, or other media files
- Key files: Logo files, brand assets

**src/auth/:**
- Purpose: Authentication logic and authorization utilities
- Contains: Role-based access control helpers
- Key files: `requireRole.ts` - function to guard routes by role

**src/components/dialogs/:**
- Purpose: Modal and dialog components
- Contains: Reusable dialog UI for confirmations, alerts, notifications
- Key files: `global-dialog.tsx` - global dialog provider for app-wide modals

**src/components/form/:**
- Purpose: Form-related helper components
- Contains: Form provider wrapper, input field wrapper, select field wrapper, error display
- Key files:
  - `FormProvider.tsx` - wraps React Hook Form
  - `FormInput.tsx` - input field with error handling
  - `FormSelect.tsx` - select/dropdown field with error handling
  - `FormError.tsx` - displays validation errors

**src/components/ui/:**
- Purpose: Base UI components built on Radix primitives
- Contains: Button, Card, Input, Dialog, Table, Collapsible, etc.
- Key files: Each file exports a single component (button.tsx, card.tsx, etc.)

**src/config/:**
- Purpose: Application configuration and constants
- Contains: User fixtures, role definitions, sidebar menu structure
- Key files:
  - `users.ts` - DUMMY_USERS for development/testing
  - `roles.ts` - ROLES enum and Role type
  - `sidebar-menu.config.ts` - menu items with role-based visibility

**src/features/rent-vehicle/:**
- Purpose: Feature module for vehicle rental functionality
- Contains: API calls, React Query hooks, mutations for rent feature
- Key files:
  - `api.ts` - API endpoint functions
  - `query.ts` - React Query hook definitions
  - `mutations.ts` - React Query mutation definitions

**src/forms/:**
- Purpose: Form components with validation schemas
- Contains: Form UI + Zod schemas + TypeScript types
- Key files:
  - `login/LoginForm.tsx` - login form component
  - `rent/RentVehicleForm.tsx` - rent vehicle form
  - `rent/rent.schema.ts` - Zod validation schema
  - `rent/rent.types.ts` - TypeScript types inferred from schema

**src/hooks/:**
- Purpose: Custom React hooks for reusable logic
- Contains: Form submission handling, PWA installation prompt, filter state management
- Key files:
  - `useFormSubmit.ts` - generic form submission handler
  - `usePWAInstall.ts` - PWA installation prompt
  - `useRentVehicleFilters.ts` - rent vehicle filter state

**src/lib/api/:**
- Purpose: HTTP client and API utilities
- Contains: Fetch wrapper with error handling
- Key files: `http.ts` - generic fetch wrapper with JSON headers

**src/lib/react-query/:**
- Purpose: React Query configuration and query utilities
- Contains: QueryClient setup with cache configuration, query key factory
- Key files:
  - `queryClient.ts` - QueryClient with default options
  - `queryKeys.ts` - React Query key factory for cache management

**src/pages/:**
- Purpose: Page/screen-level components
- Contains: Full-page layouts that combine multiple components
- Key files:
  - `DashboardPage.tsx` - dashboard with quick actions
  - `RentPage.tsx` - rent vehicle page container
  - `ReturnPage.tsx` - return vehicle page
  - `LoginPage.tsx` - login page with branding
  - `ReservationLookupPage.tsx` - reservation lookup

**src/routes/:**
- Purpose: TanStack Router file-based route definitions
- Contains: Route files using naming convention for hierarchy
- Key files:
  - `__root.tsx` - root route layout
  - `_auth.tsx` - authenticated layout (guard + sidebar)
  - `_auth.rent.tsx` - rent vehicle route (protected)
  - `_auth.dashboard.tsx` - dashboard route (protected)
  - `login.tsx` - login route (public)
  - `index.tsx` - home route redirect

**src/store/:**
- Purpose: Global state management with Zustand
- Contains: Persistent state stores
- Key files: `useAuthStore.ts` - authentication state (userId, role, isLoggedIn, login/logout methods)

**src/types/:**
- Purpose: TypeScript type definitions
- Contains: Global types, feature-specific types
- Key files:
  - `rent-vehicles/type.ts` - rent vehicle data types
  - `react-table.d.ts` - React Table type augmentations

## Key File Locations

**Entry Points:**
- `src/main.tsx`: Application bootstrap; renders React app with providers
- `src/router.ts`: Router instance creation with context type
- `src/routes/__root.tsx`: Root route layout with PWA banner
- `src/routes/_auth.tsx`: Authenticated layout with sidebar and header

**Configuration:**
- `src/config/roles.ts`: Role definitions and role type
- `src/config/users.ts`: User fixtures for testing/demo
- `src/config/sidebar-menu.config.ts`: Navigation menu structure
- `vite.config.ts`: Vite build and dev server configuration
- `tsconfig.json`: TypeScript compiler options with @ alias

**Core Logic:**
- `src/store/useAuthStore.ts`: Authentication state (Zustand)
- `src/lib/api/http.ts`: HTTP client
- `src/lib/react-query/queryClient.ts`: React Query setup
- `src/auth/requireRole.ts`: Role-based route guard

**Styles:**
- `src/index.css`: Global Tailwind styles and custom CSS

**Testing:**
- `src/setupTests.ts`: Vitest environment setup
- `vite.config.ts`: Test configuration (jsdom environment, setupFiles)

## Naming Conventions

**Files:**
- `PascalCase` for component files: `RentVehicleForm.tsx`, `Sidebar.tsx`, `DashboardPage.tsx`
- `camelCase` for utility/hook files: `useAuthStore.ts`, `useFormSubmit.ts`, `http.ts`
- `kebab-case` for directories: `form`, `rent-vehicle`, `reservation-lookup-components`
- Schema files use feature prefix: `rent.schema.ts`, `rent.types.ts`

**Components:**
- Function component names use `PascalCase`: `FormInput`, `RentVehicleForm`, `DashboardPage`
- Hook names start with `use`: `useAuthStore`, `useFormSubmit`, `usePWAInstall`
- UI components named descriptively: `Button`, `Card`, `Input`, `Dialog`

**Routes:**
- File-based routing: `/rent` route = `_auth.rent.tsx`
- Protected routes nested under `_auth` group: `_auth.*.tsx`
- Layout files use double underscore: `__root.tsx`, `_auth.tsx`
- Slug routes use bracket syntax: `[id].tsx` (if applicable)

**Types:**
- Type files end with `.types.ts`: `rent.types.ts`
- Schema files end with `.schema.ts`: `rent.schema.ts`
- Type definitions in `src/types/` directory

**Stores:**
- Zustand hooks named with `use` prefix: `useAuthStore`
- File location: `src/store/useAuthStore.ts`

## Where to Add New Code

**New Feature:**
- Create directory: `src/features/{featureName}/`
- Create form: `src/forms/{featureName}/{featureName}Form.tsx` with schema in `{featureName}.schema.ts` and types in `{featureName}.types.ts`
- Create page: `src/pages/{FeatureName}Page.tsx`
- Create route: `src/routes/_auth.{featureName}.tsx`
- Create API hooks: `src/features/{featureName}/api.ts`, `query.ts`, `mutations.ts`
- Tests: `src/__tests__/{featureName}.test.ts` or co-located with feature files

**New Component/Module:**
- Reusable UI: `src/components/ui/{ComponentName}.tsx`
- Feature-specific: `src/components/{featureName}/{ComponentName}.tsx`
- Form-related: `src/components/form/{ComponentName}.tsx`

**Utilities:**
- Generic utilities: `src/lib/utils.ts`
- API utilities: `src/lib/api/{utility}.ts`
- Custom hooks: `src/hooks/{hookName}.ts`
- Feature hooks: `src/features/{featureName}/{hookName}.ts`

**Configuration:**
- Global config: `src/config/{configName}.ts`
- Feature config: `src/features/{featureName}/config.ts`

**Types:**
- Global types: `src/types/{typeName}.ts`
- Feature types: `src/types/{featureName}/type.ts`

## Special Directories

**src/routes/:**
- Purpose: TanStack Router file-based routing
- Generated: `routeTree.gen.ts` is auto-generated; do not edit manually
- Committed: Source route files committed; routeTree.gen.ts regenerated on build
- Naming: `_auth.tsx` = layout; `_auth.rent.tsx` = nested route; `__root.tsx` = root layout

**src/__tests__/:**
- Purpose: Test files matching source files
- Generated: No
- Committed: Yes; committed with source code

**dev-dist/:**
- Purpose: Vite dev build output
- Generated: Yes (on vite dev)
- Committed: No (excluded from git)

**public/:**
- Purpose: Static assets served at root
- Generated: No
- Committed: Yes

---

*Structure analysis: 2026-01-22*
