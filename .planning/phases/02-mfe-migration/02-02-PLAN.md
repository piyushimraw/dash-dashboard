---
phase: 02-mfe-migration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/ui/src/index.ts
  - packages/ui/src/components/table/table.tsx
  - packages/ui/src/components/table/DataTable.tsx
  - packages/ui/package.json
autonomous: true

must_haves:
  truths:
    - "DataTable component can be imported from @packages/ui by MFE packages"
    - "Table primitives (Table, TableHeader, TableBody, etc.) available from @packages/ui"
    - "DataTable renders TanStack Table with sorting, filtering, and mobile card view"
  artifacts:
    - path: "packages/ui/src/components/table/table.tsx"
      provides: "Table primitive components (Table, TableHeader, TableBody, TableRow, TableHead, TableCell)"
      exports: ["Table", "TableHeader", "TableBody", "TableFooter", "TableHead", "TableRow", "TableCell", "TableCaption"]
    - path: "packages/ui/src/components/table/DataTable.tsx"
      provides: "Full-featured DataTable with TanStack Table integration"
      exports: ["DataTable", "customSortDataTable"]
  key_links:
    - from: "packages/ui/src/index.ts"
      to: "packages/ui/src/components/table/*.tsx"
      via: "barrel exports"
      pattern: "export.*from.*table"
---

<objective>
Extract DataTable and table primitives from shell to @packages/ui for reuse in mfe-reservation-lookup.

Purpose: The reservation lookup MFE needs the DataTable component. Extracting to @packages/ui enables reuse without code duplication.

Output: DataTable and table primitives available via `import { DataTable, Table } from '@packages/ui'`
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-mfe-migration/02-RESEARCH.md

# Source files to extract
@apps/shell/src/components/ui/table/table.tsx
@apps/shell/src/components/ui/table/index.tsx

# Target package
@packages/ui/src/index.ts
@packages/ui/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Copy table primitives to @packages/ui</name>
  <files>
    packages/ui/src/components/table/table.tsx
  </files>
  <action>
Create `packages/ui/src/components/table/` directory and copy table primitives:

1. Copy `apps/shell/src/components/ui/table/table.tsx` to `packages/ui/src/components/table/table.tsx`

2. Update the cn import:
   - Change `import { cn } from "@/lib/utils"` to `import { cn } from "../../lib/utils"`

The table primitives (Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption) are presentation-only components with no external dependencies beyond React and cn utility.
  </action>
  <verify>
File exists at packages/ui/src/components/table/table.tsx with correct cn import path
  </verify>
  <done>Table primitives copied to @packages/ui with corrected imports</done>
</task>

<task type="auto">
  <name>Task 2: Copy DataTable component to @packages/ui</name>
  <files>
    packages/ui/src/components/table/DataTable.tsx
    packages/ui/package.json
  </files>
  <action>
1. Copy `apps/shell/src/components/ui/table/index.tsx` to `packages/ui/src/components/table/DataTable.tsx`

2. Update imports in DataTable.tsx:
   - Change `import { Table, TableHeader, ... } from "./table"` - keep as relative import
   - Change `import clsx from "clsx"` - already available via tailwind-merge dependency
   - Keep @tanstack/react-table imports as-is

3. Update `packages/ui/package.json` to add @tanstack/react-table as peer dependency:
```json
"peerDependencies": {
  "react": "^19.0.0",
  "react-dom": "^19.0.0",
  "@tanstack/react-table": "^8.21.0"
}
```

Note: @tanstack/react-table should be peer dependency to share instance with shell/MFEs.
  </action>
  <verify>
Files exist at packages/ui/src/components/table/DataTable.tsx with correct imports
  </verify>
  <done>DataTable component copied to @packages/ui with peer dependency declared</done>
</task>

<task type="auto">
  <name>Task 3: Update @packages/ui exports and verify build</name>
  <files>
    packages/ui/src/index.ts
  </files>
  <action>
1. Add table component exports to `packages/ui/src/index.ts`:
```typescript
// Table Components
export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
} from "./components/table/table";

export { DataTable, customSortDataTable } from "./components/table/DataTable";
```

2. Run `pnpm --filter @packages/ui build` to verify compilation

3. Verify shell can import from @packages/ui by checking that `apps/shell/src/pages/ReservationLookupPage.tsx` can be updated:
   - Change `import { DataTable } from "@/components/ui/table"` to `import { DataTable } from "@packages/ui"`

4. Run `pnpm --filter @apps/shell build` to verify shell compiles with new imports
  </action>
  <verify>
Run `pnpm --filter @packages/ui build && pnpm --filter @apps/shell build` - both succeed
  </verify>
  <done>@packages/ui exports table components, shell uses @packages/ui DataTable import</done>
</task>

</tasks>

<verification>
1. `pnpm --filter @packages/ui build` passes
2. `pnpm --filter @apps/shell build` passes
3. `pnpm --filter @apps/shell dev` starts and reservation lookup page renders table
4. Table sorting and filtering still works
</verification>

<success_criteria>
- Table components extracted to packages/ui/src/components/table/
- @packages/ui exports DataTable, Table, TableHeader, etc.
- Shell ReservationLookupPage imports DataTable from @packages/ui
- All builds pass, table renders and functions correctly
</success_criteria>

<output>
After completion, create `.planning/phases/02-mfe-migration/02-02-SUMMARY.md`
</output>
